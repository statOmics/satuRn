<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test function to obtain a top list of transcripts that are
differentially used in the contrast of interest — testDTU • satuRn</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Test function to obtain a top list of transcripts that are
differentially used in the contrast of interest — testDTU"><meta property="og:description" content="Function to test for differential transcript usage (DTU)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">satuRn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vignette.html">Main vignette: transcript-level analyses</a>
    </li>
    <li>
      <a href="../articles/Vignette_eqclass.html">Vignette for equivalence class-level analyses</a>
    </li>
    <li>
      <a href="../articles/Vignette_exon.html">Vignette for exon-level analyses</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/statOmics/satuRn/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test function to obtain a top list of transcripts that are
differentially used in the contrast of interest</h1>
    <small class="dont-index">Source: <a href="https://github.com/statOmics/satuRn/blob/HEAD/R/testDTU.R" class="external-link"><code>R/testDTU.R</code></a></small>
    <div class="hidden name"><code>testDTU.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to test for differential transcript usage (DTU)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">testDTU</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">contrasts</span>,</span>
<span>  diagplot1 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  diagplot2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sort <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  forceEmpirical <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A `SummarizedExperiment` instance containing a list of objects 
of the `StatModel` class as obtained by the `fitDTU` function of the 
`satuRn` package.</p></dd>


<dt>contrasts</dt>
<dd><p>`numeric` matrix specifying one or more contrasts of 
the linear model coefficients to be tested. The rownames of the matrix 
should be equal to the names of parameters of the model that are 
involved in the contrast. The column names of the matrix will be used 
to construct names to store the results in the rowData of 
the SummarizedExperiment.</p></dd>


<dt>diagplot1</dt>
<dd><p>`boolean(1)` Logical, defaults to TRUE. If set to TRUE,
a plot of the histogram of the z-scores (computed from p-values) is 
displayed using the locfdr function of the `locfdr` package. The blue 
dashed curve is fitted to the mid 50<!-- % of the z-scores, which are assumed  -->
to originate from null transcripts, thus representing the estimated 
empirical null component densities. The maximum likelihood estimates 
(MLE) and central matching estimates  (CME) of this estimated empirical 
null distribution are given below the plot. If the values for delta and
sigma deviate from 0 and 1 respectively, the downstream inference will 
be influenced by the empirical adjustment implemented in satuRn.</p></dd>


<dt>diagplot2</dt>
<dd><p>`boolean(1)` Logical, defaults to TRUE. If set to TRUE,
a plot of the histogram of the "empirically adjusted" test statistics and 
the standard normal distribution will be displayed. Ideally, the majority
(mid portion) of the adjusted test statistics should follow the standard 
normal.</p></dd>


<dt>sort</dt>
<dd><p>`boolean(1)` Logical, defaults to FALSE. If set to TRUE, 
the output of the topTable test function is sorted according to 
the empirical p-values.</p></dd>


<dt>forceEmpirical</dt>
<dd><p>`boolean(1)` Logical, defaults to FALSE. If there are
less than 500 features in a particular contrast, satuRn will by default
not perform its empirical correction of p-values and only output raw
p-values. By setting this parmater to TRUE, this behaviour can be
overwritten and satuRn will try to perform the empirical correction
anyway. Use with caution! Carefully inspect the two diagplots to assess
if the correction is reasonable.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An updated `SummarizedExperiment` that contains the `Dataframes` 
    that display the significance of DTU for each transcript 
    in each contrast of interest.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeroen Gilis</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sumExp_example</span>, package <span class="op">=</span> <span class="st">"satuRn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sumExp</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitDTU.html">fitDTU</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    object <span class="op">=</span> <span class="va">sumExp_example</span>,</span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>    parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">sumExp</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Contrast1"</span>, <span class="st">"Contrast2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VISp.L5_IT_VISp_Hsd11b1_Endou"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"ALM.L5_IT_ALM_Tnc"</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VISp.L5_IT_VISp_Hsd11b1_Endou"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"ALM.L5_IT_ALM_Tmem163_Dmrtb1"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sumExp</span> <span class="op">&lt;-</span> <span class="fu">testDTU</span><span class="op">(</span>object <span class="op">=</span> <span class="va">sumExp</span>, </span></span>
<span class="r-in"><span>    contrasts <span class="op">=</span> <span class="va">L</span>, </span></span>
<span class="r-in"><span>    diagplot1 <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    diagplot2 <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    sort <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    forceEmpirical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="testDTU-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="testDTU-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="testDTU-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="testDTU-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeroen Gilis.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

